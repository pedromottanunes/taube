<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gerar Campanha • OD Drive</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

  <style>
    :root {
      --od-primary: #0f766e;
      --od-primary-light: #14b8a6;
      --od-secondary: #0891b2;
    }
    
    .bg-gradient-primary {
      background: linear-gradient(135deg, var(--od-primary) 0%, var(--od-primary-light) 100%);
    }
    
    .bg-gradient-secondary {
      background: linear-gradient(135deg, var(--od-secondary) 0%, var(--od-primary-light) 100%);
    }
    
    .border-gradient {
      border: 2px solid transparent;
      background: linear-gradient(white, white) padding-box,
                  linear-gradient(135deg, var(--od-primary), var(--od-primary-light)) border-box;
    }
    
    .input-focus {
      transition: all 0.3s ease;
    }
    
    .input-focus:focus {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(15, 118, 110, 0.15);
    }
    
    .btn-primary {
      background: linear-gradient(135deg, var(--od-primary) 0%, var(--od-primary-light) 100%);
      transition: all 0.3s ease;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 35px rgba(15, 118, 110, 0.3);
    }
    
    .btn-primary:active {
      transform: translateY(0);
    }
    
    .card-container {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .floating-label {
      transition: all 0.3s ease;
    }
    
    .input-group:focus-within .floating-label {
      transform: translateY(-8px) scale(0.85);
      color: var(--od-primary);
    }
    
    .input-group input:not(:placeholder-shown) + .floating-label {
      transform: translateY(-8px) scale(0.85);
      color: var(--od-primary);
    }
    
    .upload-area {
      transition: all 0.3s ease;
      border: 2px dashed #d1d5db;
    }
    
    .upload-area:hover {
      border-color: var(--od-primary);
      background-color: rgba(15, 118, 110, 0.05);
    }
    
    .upload-area.dragover {
      border-color: var(--od-primary-light);
      background-color: rgba(20, 184, 166, 0.1);
      transform: scale(1.02);
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .animate-fade-in-up {
      animation: fadeInUp 0.6s ease-out;
    }
    
    .animate-delay-100 { animation-delay: 0.1s; }
    .animate-delay-200 { animation-delay: 0.2s; }
    .animate-delay-300 { animation-delay: 0.3s; }
    
    .icon-field {
      position: relative;
    }
    
    .icon-field .icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: #6b7280;
      transition: color 0.3s ease;
    }
    
    .icon-field input:focus + .icon {
      color: var(--od-primary);
    }
    
    .icon-field input {
      padding-left: 40px;
    }
  </style>
</head>

<body class="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-teal-50 px-4 py-8">
  <!-- Background Pattern -->
  <div class="fixed inset-0 opacity-5">
    <div class="absolute inset-0" style="background-image: radial-gradient(circle at 25% 25%, var(--od-primary) 2px, transparent 2px); background-size: 50px 50px;"></div>
  </div>

  <!-- Main Container -->
  <div class="relative max-w-2xl mx-auto">
    <!-- Header Section -->
    <div class="text-center mb-8 animate-fade-in-up">

      
      
    <h1 class="flex items-center justify-center text-4xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent mb-2 gap-3">
  <!-- Ícone do Dropbox (exemplo): -->
  <img src="https://www.dropbox.com/scl/fi/1lcom3fqzeltyx32h1jya/logood.png?rlkey=ko8p8yvfwjhxndelr8u6tzibz&st=8yqcsrq9&dl=1" alt="Ícone" class="w-12 h-6 mr-2">
 
</h1>

      

      <div class="w-24 h-1 bg-gradient-primary rounded-full mx-auto mt-4"></div>
    </div>

    <!-- Form Container -->
    <div class="card-container rounded-3xl shadow-2xl p-8 animate-fade-in-up animate-delay-100">
      <form id="odForm" class="space-y-8">
        
        <!-- Company Information Section -->
        <div class="space-y-6">
          <h2 class="text-xl font-semibold text-gray-800 flex items-center gap-2">
            <i data-lucide="building-2" class="w-5 h-5 text-teal-600"></i>
            Informações da Empresa
          </h2>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Company Name -->
            <div class="lg:col-span-2 icon-field">
              <input 
                id="company_name" 
                name="company_name" 
                required
                placeholder="Nome da empresa"
                class="w-full h-14 rounded-xl border-2 border-gray-200 input-focus focus:border-teal-500 focus:ring-0 text-gray-800 font-medium"
              >
              <i data-lucide="building" class="icon w-5 h-5"></i>
            </div>

            <!-- Website -->
            <div class="icon-field">
              <input 
                id="site_url" 
                name="site_url" 
                type="url" 
                required
                placeholder="https://exemplo.com"
                class="w-full h-14 rounded-xl border-2 border-gray-200 input-focus focus:border-teal-500 focus:ring-0 text-gray-800"
              >
              <i data-lucide="globe" class="icon w-5 h-5"></i>
            </div>

            <!-- City -->
            <div class="icon-field">
              <input 
                id="city" 
                name="city" 
                required
                placeholder="Cidade"
                class="w-full h-14 rounded-xl border-2 border-gray-200 input-focus focus:border-teal-500 focus:ring-0 text-gray-800"
              >
              <i data-lucide="map-pin" class="icon w-5 h-5"></i>
            </div>

          <!-- Título dos produtos -->
<h2 class="text-lg font-bold text-gray-700 mt-4 mb-2 flex items-center gap-2">
  <i data-lucide="package" class="w-5 h-5 text-teal-600"></i>
  Produtos da Campanha
</h2>

<!-- Cards de produtos -->
<div id="product_wrapper" class="space-y-4"></div>

<!-- Botão adicionar produto -->
<button type="button" id="addProduct" class="flex items-center gap-2 text-teal-700 font-medium hover:text-teal-900 transition mt-2">
  <i data-lucide="plus-circle" class="w-5 h-5"></i>
  Adicionar outro produto
</button>



          
        <!-- Project Details Section -->
        <div class="space-y-6">
          <h2 class="text-xl font-semibold text-gray-800 flex items-center gap-2">
            <i data-lucide="settings" class="w-5 h-5 text-teal-600"></i>
            Detalhes do Projeto
          </h2>
          
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">

            
           


          <!-- Dias de campanha -->
<div class="icon-field">
  <input 
    id="campaign_days"
    name="campaign_days"
    type="number"
    min="1"
    required
    placeholder="Dias de campanha"
    class="w-full h-14 rounded-xl border-2 border-gray-200 input-focus focus:border-teal-500 focus:ring-0 text-gray-800"
  >
  <i data-lucide="calendar-days" class="icon w-5 h-5"></i>
</div>


                 

        <!-- File Upload Section -->
        <div class="space-y-6">
          <h2 class="text-xl font-semibold text-gray-800 flex items-center gap-2">
            <i data-lucide="upload" class="w-5 h-5 text-teal-600"></i>
            Imagem de referência
          </h2>
          
          <div class="upload-area rounded-xl p-2 text-center cursor-pointer" id="uploadArea">
            <input 
              id="mockup_image" 
              name="mockup_image" 
              type="file"
              accept="image/png,image/jpeg" 
              required
              class="hidden"
            >
            <div class="upload-content">
              <div class="inline-flex items-center justify-center w-6 h-6 bg-gray-100 rounded-full mb-4">
                <i data-lucide="image" class="w-4 h-4 text-gray-400"></i>
              </div>
              <p class="text-lg font-medium text-gray-700 mb-2">Clique para enviar ou arraste aqui</p>
              <p class="text-sm text-gray-500">PNG ou JPG até 10MB</p>
            </div>
            <div class="file-preview hidden">
              <div class="inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4">
                <i data-lucide="check" class="w-8 h-8 text-green-600"></i>
              </div>
              <p class="text-lg font-medium text-green-700 mb-2">Arquivo selecionado</p>
              <p class="text-sm text-gray-600 file-name"></p>
            </div>
          </div>
        </div>

        <!-- Submit Button -->
       <button 
  type="submit"
  class="w-full h-16 mt-4 btn-primary text-white font-bold text-lg rounded-xl shadow-lg flex items-center justify-center gap-3"
>
  <i data-lucide="send" class="w-6 h-6"></i>
  Gerar Campanha
</button>


        <!-- Status Message -->
        <div id="msg" class="text-center text-sm mt-4 hidden"></div>
      </form>
    </div>

    <!-- Footer -->
    <div class="text-center mt-8 text-gray-500 text-sm animate-fade-in-up animate-delay-300">
      <p>© 2025 OD Drive. Todos os direitos reservados.</p>
    </div>
  </div>

  <script>
    // Initialize Lucide icons
    lucide.createIcons();

    // Configuration
    const WEBHOOK_URL = 'https://hook.us2.make.com/7oibqbjdcjbhjrayxruwc0a73f73if8i';

    // DOM References
    const form = document.getElementById('odForm');
    const msg = document.getElementById('msg');
    const inputFile = document.getElementById('mockup_image');
    const uploadArea = document.getElementById('uploadArea');
    const uploadContent = uploadArea.querySelector('.upload-content');
    const filePreview = uploadArea.querySelector('.file-preview');
    const fileName = uploadArea.querySelector('.file-name');


/* Produtos dinâmicos */
const productWrapper = document.getElementById('product_wrapper');
const addProductBtn  = document.getElementById('addProduct');
let productCount = 1;

function createProductSelect(id, showRemove = true) {
  const wrapper = document.createElement('div');
  wrapper.className = "rounded-xl bg-slate-50 border border-gray-200 p-4 mb-2 flex flex-col gap-2 shadow-sm relative product-item";

  // Grid de inputs do produto
  const row = document.createElement('div');
  row.className = "grid grid-cols-1 md:grid-cols-4 gap-3 items-end";

  // --- Campo: Produto (select) ---
  const prodField = document.createElement('div');
  prodField.className = "flex flex-col";
  const prodLabel = document.createElement('label');
  prodLabel.textContent = "Produto";
  prodLabel.className = "text-xs text-gray-600 mb-1";
  const select = document.createElement('select');
  select.id = 'product_' + id;
  select.name = 'product[]';
  select.required = true;
  select.className = 'h-12 rounded-lg border-2 border-gray-200 input-focus focus:border-teal-500 text-gray-800 px-3';
  select.innerHTML = `
    <option value="" disabled selected>Selecione</option>
    <option value="OD_VT">OD VT</option>
    <option value="OD_DROP">OD DROP</option>
    <option value="OD_PACK">OD PACK</option>
    <option value="OD_FULL">OD FULL</option>
    <option value="OD_LIGHT">OD LIGHT</option>
  `;
  prodField.appendChild(prodLabel);
  prodField.appendChild(select);

  // --- Campo: Preço Unitário ---
  const priceField = document.createElement('div');
  priceField.className = "flex flex-col";
  const priceLabel = document.createElement('label');
  priceLabel.textContent = "Preço unitário (R$)";
  priceLabel.className = "text-xs text-gray-600 mb-1";
  const inputPrice = document.createElement('input');
  inputPrice.type = 'number';
  inputPrice.step = '0.01';
  inputPrice.min = '0';
  inputPrice.placeholder = 'Preço';
  inputPrice.required = true;
  inputPrice.className = 'h-12 rounded-lg border-2 border-gray-200 input-focus focus:border-teal-500 text-gray-800 px-3';
  inputPrice.name = 'unit_price[]';
  priceField.appendChild(priceLabel);
  priceField.appendChild(inputPrice);

  // --- Campo: Qtd carros ---
  const qtdField = document.createElement('div');
  qtdField.className = "flex flex-col";
  const qtdLabel = document.createElement('label');
  qtdLabel.textContent = "Qtd carros";
  qtdLabel.className = "text-xs text-gray-600 mb-1";
  const inputQtd = document.createElement('input');
  inputQtd.type = 'number';
  inputQtd.min = '1';
  inputQtd.placeholder = 'Qtd';
  inputQtd.required = true;
  inputQtd.className = 'h-12 rounded-lg border-2 border-gray-200 input-focus focus:border-teal-500 text-gray-800 px-3';
  inputQtd.name = 'cars_qtd[]';
  qtdField.appendChild(qtdLabel);
  qtdField.appendChild(inputQtd);

  // --- Campo: Desconto ---
  const discountField = document.createElement('div');
  discountField.className = "flex flex-col";
  const discountLabel = document.createElement('label');
  discountLabel.textContent = "Desconto (R$)";
  discountLabel.className = "text-xs text-gray-600 mb-1";
  const inputDiscount = document.createElement('input');
  inputDiscount.type = 'number';
  inputDiscount.step = '0.01';
  inputDiscount.min = '0';
  inputDiscount.value = '0';
  inputDiscount.placeholder = 'Desconto';
  inputDiscount.required = true;
  inputDiscount.className = 'h-12 rounded-lg border-2 border-gray-200 input-focus focus:border-teal-500 text-gray-800 px-3';
  inputDiscount.name = 'discount[]';
  discountField.appendChild(discountLabel);
  discountField.appendChild(inputDiscount);

  // Adiciona todos na linha
  row.appendChild(prodField);
  row.appendChild(priceField);
  row.appendChild(qtdField);
  row.appendChild(discountField);

  wrapper.appendChild(row);

  // Botão remover (só para >1 produto)
  if (showRemove) {
    const removeBtn = document.createElement('button');
    removeBtn.type = "button";
    removeBtn.title = "Remover produto";
    removeBtn.innerHTML = '<i data-lucide="x-circle" class="w-5 h-5 text-red-500"></i>';
    removeBtn.className = "absolute top-2 right-2 p-1 bg-white rounded-full shadow-sm hover:bg-red-50";
    removeBtn.onclick = () => {
      wrapper.remove();
    };
    wrapper.appendChild(removeBtn);
  }

  return wrapper;
}

// Inicial (primeiro produto, sem botão remover)
productWrapper.innerHTML = '';
productWrapper.appendChild(createProductSelect(1, false));
productCount = 1;

// Botão adicionar produto
addProductBtn.onclick = () => {
  productCount++;
  productWrapper.appendChild(createProductSelect(productCount, true));
  lucide.createIcons();
};






    

    // Utility function for messages
    function showMsg(text, ok = true) {
      msg.textContent = text;
      msg.className = `text-center text-sm mt-4 ${ok ? 'text-teal-600' : 'text-red-600'}`;
      msg.classList.remove('hidden');
    }

    // File upload handling
    uploadArea.addEventListener('click', () => inputFile.click());

    uploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      uploadArea.classList.add('dragover');
    });

    uploadArea.addEventListener('dragleave', () => {
      uploadArea.classList.remove('dragover');
    });

    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.classList.remove('dragover');
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        inputFile.files = files;
        updateFilePreview(files[0]);
      }
    });

    inputFile.addEventListener('change', (e) => {
      if (e.target.files.length > 0) {
        updateFilePreview(e.target.files[0]);
      }
    });

    function updateFilePreview(file) {
      if (file && ['image/png', 'image/jpeg'].includes(file.type)) {
        uploadContent.classList.add('hidden');
        filePreview.classList.remove('hidden');
        fileName.textContent = file.name;
      }
    }

    // Form submission
    form.addEventListener('submit', async (ev) => {
      ev.preventDefault();
      msg.classList.add('hidden');

      // Validate image
      const file = inputFile.files[0];
      if (!file || !['image/png', 'image/jpeg'].includes(file.type)) {
        showMsg('❌ Selecione uma imagem PNG ou JPG', false);
        return;
      }

      // Show loading state
      const submitBtn = form.querySelector('button[type="submit"]');
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = '<i data-lucide="loader-2" class="w-6 h-6 animate-spin"></i> Enviando...';
      submitBtn.disabled = true;
      lucide.createIcons();

      try {
            const fd = new FormData();
            fd.set('company_name', form.company_name.value);
            fd.set('site_url', form.site_url.value);
            fd.set('city', form.city.value);
            fd.set('products', JSON.stringify(productsArr));
            fd.set('campaign_days', form.campaign_days?.value || '');
            fd.set('mockup_image', file);
            
            // Coletar todos os produtos e seus preços unitários:
            const productSelects = productWrapper.querySelectorAll('select[name="product[]"]');
            const priceInputs    = productWrapper.querySelectorAll('input[name="unit_price[]"]');
            const qtdInputs      = productWrapper.querySelectorAll('input[name="cars_qtd[]"]');
            const discountInputs = productWrapper.querySelectorAll('input[name="discount[]"]');
            const productsArr    = [];
            
            productSelects.forEach((select, idx) => {
              const produto = select.value;
              const preco   = priceInputs[idx].value;
              const qtd     = qtdInputs[idx].value;
              const desconto = discountInputs[idx].value;
              if (produto && preco && qtd && desconto !== undefined) {
                productsArr.push({
                  produto,
                  preco,
                  qtd,
                  desconto
                });
              }
            });

            
            // Enviar como JSON string (no Make você acessa como texto e depois separa, ou pode separar no Make usando Parse JSON)
            fd.set('products', JSON.stringify(productsArr));
            
            const res = await fetch(WEBHOOK_URL, { method: 'POST', body: fd });





        
        if (!res.ok) throw new Error('Webhook ' + res.status);
      
        
        showMsg('✅ Dados enviados com sucesso!');
        form.reset();
        uploadContent.classList.remove('hidden');
        filePreview.classList.add('hidden');
      } catch (err) {
        console.error(err);
        showMsg('Erro ao enviar: ' + (err.message || err), false);
      } finally {
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        lucide.createIcons();
      }
    });

    // Input animations
    document.querySelectorAll('input').forEach(input => {
      input.addEventListener('focus', () => {
        input.parentElement.classList.add('focused');
      });
      
      input.addEventListener('blur', () => {
        input.parentElement.classList.remove('focused');
      });
    });
  </script>
</body>
</html>

