<!DOCTYPE html>
<html lang="pt-BR">
<!-- =========================================================
     FORMULÁRIO “Gerar Orçamento – OD Drive”
     ---------------------------------------------------------
     • Envia multipart (inputs + arquivo) ao Webhook do Make
     • O Make recebe mockup_image            (name/type/data)
     • Cenário salva no Drive, gera slides, etc.
     ========================================================= -->
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gerar Orçamento • OD Drive</title>

  <!-- Tailwind CDN (protótipo) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{ --od-primary:#0f766e; }
    .bg-primary{background-color:var(--od-primary)}
    .focus\:ring-primary:focus{
      --tw-ring-color:var(--od-primary);
      --tw-ring-opacity:.6}
  </style>
</head>

<body class="min-h-screen flex items-center justify-center bg-gray-100 px-2">
<!-- ======================= CONTAINER ======================= -->
<section class="w-full max-w-lg bg-white rounded-2xl shadow-xl p-6 sm:p-8">
  <h1 class="text-2xl sm:text-3xl font-semibold text-center text-gray-800 mb-8">
    Gerar Orçamento&nbsp;– OD Drive
  </h1>

  <!-- ==================== FORM INÍCIO ===================== -->
  <form id="odForm" class="space-y-6">

    <!-- ---------- Grupo: dados principais ---------- -->
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <!-- Empresa -->
      <div class="sm:col-span-2">
        <label class="block text-sm mb-1" for="company_name">Empresa</label>
        <input id="company_name" name="company_name" required
               class="w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-primary">
      </div>

      <!-- Site -->
      <div>
        <label class="block text-sm mb-1" for="site_url">Site</label>
        <input id="site_url" name="site_url" type="url" required
               placeholder="https://exemplo.com"
               class="w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-primary">
      </div>

      <!-- Cidade -->
      <div>
        <label class="block text-sm mb-1" for="city">Cidade</label>
        <input id="city" name="city" required
               class="w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-primary">
      </div>

      <!-- Objetivo -->
      <div class="sm:col-span-2">
        <label class="block text-sm mb-1" for="objective">Objetivo</label>
        <input id="objective" name="objective" required
               class="w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-primary">
      </div>

      <!-- Upload -->
      <div class="sm:col-span-2">
        <label class="block text-sm mb-1" for="mockup_image">
          Imagem / Mockup (PNG ou JPG)
        </label>
        <input id="mockup_image" name="mockup_image" type="file"
               accept="image/png,image/jpeg" required
               class="w-full rounded-lg border-gray-300 bg-white focus:ring-2 focus:ring-primary">
      </div>
    </div>

    <!-- ---------- Grupo: números ---------- -->
    <div class="grid grid-cols-2 gap-4">
      <div>
        <label class="block text-sm mb-1" for="cars_qtd">Qtd.&nbsp;Carros</label>
        <input id="cars_qtd" name="cars_qtd" type="number" min="1" required
               class="w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-primary">
      </div>
      <div>
        <label class="block text-sm mb-1" for="discount">Desconto&nbsp;(R$)</label>
        <input id="discount" name="discount" type="number" step="0.01" value="0"
               class="w-full rounded-lg border-gray-300 focus:ring-2 focus:ring-primary">
      </div>
    </div>

    <!-- ---------- Botão Submit ---------- -->
    <button type="submit"
            class="w-full py-3 bg-primary text-white font-semibold rounded-lg
                   hover:opacity-90 transition-all shadow-sm">
      Gerar Orçamento
    </button>

    <!-- Mensagem dinâmica -->
    <p id="msg" class="text-center text-sm mt-2 hidden"></p>
  </form>
  <!-- ==================== FORM FIM ===================== -->
</section>
<!-- ===================== CONTAINER FIM ================= -->

<!-- ==================================================================== -->
<script>
/* ╔═════════════════════ CONFIGURAÇÃO ════════════════════════╗ */
const WEBHOOK_URL = 'https://hook.us2.make.com/ssddbgjp5jqdwpdcmmbrx14d2chwmxxa'; //  <<< troque aqui
/* ╚═══════════════════════════════════════════════════════════╝ */

/* --------- Referências DOM --------- */
const form      = document.getElementById('odForm');
const msg       = document.getElementById('msg');
const inputFile = document.getElementById('mockup_image');

/* --------- Utilitário para mensagens --------- */
function showMsg(text, ok = true){
  msg.textContent = text;
  msg.className   = `text-center text-sm mt-2 ${ ok ? 'text-primary' : 'text-red-600' }`;
  msg.classList.remove('hidden');
}

/* --------- Envio --------- */
form.addEventListener('submit', async ev => {
  ev.preventDefault(); msg.classList.add('hidden');

  /* valida imagem */
  const file = inputFile.files[0];
  if(!file || !['image/png','image/jpeg'].includes(file.type)){
    showMsg('❌ Selecione uma imagem PNG ou JPG', false); return;
  }

  /* monta multipart */
  const fd = new FormData(form);        // inclui todos os campos texto/number
  fd.set('mockup_image', file);         // garante o arquivo no mesmo campo

  try{
    const res = await fetch(WEBHOOK_URL, { method:'POST', body: fd });
    if(!res.ok) throw new Error('Webhook '+res.status);
    showMsg('✅ Orçamento enviado com sucesso!');
    form.reset();
  }catch(err){
    console.error(err);
    showMsg('Erro ao enviar: '+(err.message || err), false);
  }
});
</script>
</body>
</html>
